# è·¯å¾„çº§ä¾èµ–æ³¨å…¥   
åœ¨fastapiä¸­,è·¯å¾„çº§ä¾èµ–æ³¨å…¥æ˜¯æœ€å¸¸ç”¨çš„æ–¹å¼ï¼Œå®ƒå…è®¸æˆ‘ä»¬åœ¨å•ä¸ªè·¯ç”±ä¸­æ³¨å…¥ä¾èµ–é¡¹  
è¿™äº›ä¾èµ–ä¼šåœ¨è¯·æ±‚åˆ°è¾¾è·¯ç”±å¤„ç†å‡½æ•°ä¹‹å‰æ‰§è¡Œ,å¹¶å¯ä»¥ç”¨äºå‚æ•°éªŒè¯ã€æƒé™æ£€æŸ¥ã€æ•°æ®åº“è¿æ¥ç­‰  

- ç‰¹ç‚¹
1. ä½œç”¨èŒƒå›´:ä»…å½±å“å½“å‰è·¯å¾„æ“ä½œ
2. æ‰§è¡Œé¡ºåºï¼šä¾èµ–é¡¹åœ¨è·¯ç”±å¤„ç†å‡½æ•°ä¹‹å‰æ‰§è¡Œ
3. å‚æ•°ä¼ é€’ï¼šä¾èµ–é¡¹å¯ä»¥è®¿é—®è¯·æ±‚å‚æ•°
4. è¿”å›å€¼ï¼šä¾èµ–é¡¹å¯ä»¥è¿”å›æ•°æ®ï¼Œä¾›è·¯ç”±å¤„ç†å‡½æ•°ä½¿ç”¨

> ä¹‹å‰çš„ä»‹ç»ä¸­å·²ç»å†™äº†ä¸€ç§å†™æ³•,å°±æ˜¯å†™åœ¨è§†å›¾å‡½æ•°å½“ä¸­  
> âš ï¸ä¸è¿‡å€¼å¾—ä¸€çœ‹çš„æ˜¯è¿™æ¬¡è·å–çš„æ–¹å¼æ˜¯ä½¿ç”¨æˆ‘ä»¬è‡ªå·±æŒ‡å®šçš„æŸ¥è¯¢å‚æ•°ç»“åˆè¿”å›å­—å…¸çš„é”®æ¥è¿›è¡Œç´¢å¼•çš„  
> ç®€å•ç†è§£å°±æ˜¯è¿”å›çš„æ˜¯ä¸ªå­—å…¸ï¼Œç„¶åæˆ‘ä»¬æŒ‡å®šçš„æŸ¥è¯¢å‚æ•°åˆæ˜¯ä¾èµ–æ³¨å…¥çš„â€œæ›¿èº«â€ğŸ˜
```python
#tips:å®šä¹‰ä¸€ä¸ªè·å–åˆ†é¡µçš„å‚æ•°
def get_pagination_params(
        page:Annotated[int,Query(1,g1=1)],
        page_size:Annotated[int,Query(10,g1=1,le=100)]
):
    return {
        'page':page,
        'page_size':page_size,
    }

@app.get('/items/')
async def  get_items(pagination:int=Depends(get_pagination_params)):
    return {
        'items':[f'item{i}' for i in  range(1,4)],
        'current_page':pagination['page'],
        'page_size':pagination['page_size'],
    }

```


> å…¶å®è¿˜æœ‰å¦å¤–ä¸€ç§å†™æ³•ï¼Œå°±æ˜¯å†™åœ¨è·¯å¾„å½“ä¸­
```python

#tips:å®šä¹‰ä¸€ä¸ªå‡½æ•°æ£€æŸ¥token
def  check_user_permission(token:str=Header(...)): #tips:å›é¡¾ä¸€ä¸‹ï¼Œç‚¹ç‚¹ç‚¹æ˜¯æœªå†™å‚æ•°ä½†æ˜¯å¿…å¡«çš„æ„æ€
    if  token!='secret-token': #tips:è¿™é‡Œæ²¡å•ç‹¬ç”Ÿæˆtoken,å…ˆç”¨ä¸ªå‡çš„'secret-token'æ›¿ä»£
        raise HTTPException(
            status_code=status.HTTP_403_FORBIDDEN,
            detail='Invalid token'
        )
    return {
        'user':'admin'
    }

@app.get("/admin/",dependencies=[Depends(check_user_permission)])
async def  admin_dashbord():
    return {
        'message':'welcome to admin dashboard'
    }
```
![img.png](img.png)

## æ€»ç»“
æŠŠæŸ¥è¯¢å‚æ•°æˆ–æ˜¯åˆ«çš„åŠŸèƒ½é›†æˆåˆ°äº†ä¾èµ–å‡½æ•°é‡Œè¾¹äº†ï¼Œ   
å¾ˆå¤šåœ¨è¯·æ±‚æ—¶å€™éœ€è¦å¡«å†™çš„å‚æ•°å…¶å®æ˜¯ä¾èµ–å‡½æ•°ä¸­çš„å‚æ•°
ç†è§£äº†è¿™ä¸¤ç‚¹ä¹‹åå°±æ˜ç™½å¤šäº†